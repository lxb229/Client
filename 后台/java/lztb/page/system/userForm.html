<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width">
    <title>新增/编辑用户</title>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link href="/lztb/static/plugs/layui/css/layui.css" rel="stylesheet">
</head>
<body>
    <div id="form_user" class="layui-form" style="padding: 25px;">
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label"><i class="required-symbol"></i>登录账号</label>
                <div class="layui-input-block">
                    <input type="text" maxlength="20" class="layui-input" v-model="input.loginName" />
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label"><i class="required-symbol"></i>初始化密码</label>
                <div class="layui-input-block">
                    <input type="text" maxlength="20" class="layui-input" disabled value="lztb123" />
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">是否启用</label>
                <div class="layui-input-inline">
                    <input type="checkbox" name="close" lay-skin="switch" lay-text="启用|禁用" checked />
                </div>
            </div>
        </div>
        <div class="layui-form-item" style="margin-left: 46%;">
            <button class="layui-btn" v-on:click="addUser()"> 保存 </button>
        </div>
    </div>

    <script type="text/javascript" src="/lztb/static/plugs/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="/lztb/static/plugs/layui/layui.js"></script>
    <script type="text/javascript" src="/lztb/static/plugs/vue/vue.js"></script>
    <script type="text/javascript" src="/lztb/static/model/site.js"></script>
    <script type="text/javascript">
        if (window.parent.window.gCloseModalWindow) {
            window.gCloseModalWindow = window.parent.window.gCloseModalWindow;
        }
        if (window.parent.window.AlertMsg) {
            window.AlertMsg = window.parent.window.AlertMsg;
        } else {
            window.AlertMsg = alert;
        }
        window.location.reload = window.parent.window.location.reload;
        window.baseUrl = window.parent.window.baseUrl;

        var layuiForm;
        layui.config({ dir: '/lztb/static/plugs/layui/' });
        layui.use(['layer', 'form', 'element'], function () {
            //layuiForm = layui.form();
        });

        var app = new Vue({
            el: "#form_user",
            data: {
                input: {
                    loginName: '',
                    userStatus: 0
                }
            },
            methods: {
                addUser: function () {
                    var status = $('.layui-unselect em').text();
                    if (status == '启用') {
                        this.input.userStatus = 1;
                    } else {
                        this.input.userStatus = 0;
                    }
                    var options = {
                        loginName: app.input.loginName,
                        userStatus: app.input.userStatus
                    };

                    //执行Ajax操作
                    $.ajax({
                        url: '/system/users/addOrUpdate',
                        type: 'POST',
                        data: options,
                        dataType: 'json',
                        timeout: 10000,
                        success: function (rs) {
                            if (rs.code == '00000') {
                                gCloseModalWindow();
                                window.parent.window.location.reload();
                            } else {
                                console.log(rs.msg);
                                AlertMsg(rs.msg);
                            }
                        },
                        error: function (xhr, status, ex) {
                            AlertMsg("请求失败：" + xhr.statusText);
                            console.error(ex);
                        }
                    });
                    return false;
                }
            },
        });
    </script>
</body>

</html>