<!DOCTYPE html>
<html>

<head>
	<meta name="viewport" content="width=device-width">
	<title>新增/编辑角色</title>
	<meta charset="UTF-8">
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link href="/lztb/static/plugs/layui/css/layui.css" rel="stylesheet">
</head>

<body>
	<!--内容-->
	<div id="app" class="layui-form" style="padding: 25px;">
		<div class="layui-form-item">
			<label class="layui-form-label">角色名称</label>
			<div class="layui-input-block">
				<input type="text" maxlength="15" v-model="roleName" name="roleName" class="layui-input">
			</div>
		</div>
		<div class="hr-line-dashed"></div>
		<div class="layui-form-item text-center">
				<label class="layui-form-label"></label>
			<button class="layui-btn" @click="saveData()">保存数据</button>
		</div>
	</div>
	<script type="text/javascript" src="/lztb/static/plugs/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/lztb/static/plugs/layui/layui.js"></script>
	<script type="text/javascript" src="/lztb/static/plugs/vue/vue.js"></script>
	<script type="text/javascript" src="/lztb/static/model/site.js"></script>
	<script type="text/javascript">
		layui.use(['layer', 'form', 'element'], function () {

		});

		var vm = new Vue({
			el: "#app",
			data: {
				roleId: null,
				roleName: null
			},
			methods: {
				saveData: function () {
					if(!vm.roleName) {
						AlertMsg("角色名称不能为空!");
						return;
					}
					$.ajax({
						url: '/system/roles/addOrUpdate',
						type: 'POST',
						data: {
							"roleId":vm.roleId,
							"roleName":vm.roleName
						},
						dataType: 'json',
						timeout: 10000,
						success: function (rs) {
							if (rs.code == '00000') {
								top.gCloseModalWindow();
								top.SuccessBox("角色保存成功!", "提示", 3000);
							} else {
								AlertMsg(rs.msg);
								console.error(rs);
							}
						},
						error: function (xhr, status, ex) {
							AlertMsg("请求失败：" + xhr.statusText);
							console.error(ex);
						}
					});
				}
			},
			created:function() {
				var roleData = localStorage.getItem("system_role_update_data");
				if(!roleData) {
					return;
				}
				roleData = JSON.parse(roleData);
				this.roleId = roleData.roleId;
				this.roleName = roleData.roleName;
			}
		});
	</script>
</body>

</html>