<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wangzhixuan.mapper.GoldLogMapper">

	<!-- 通用查询映射结果 -->
	<resultMap id="GoldLog" type="com.wangzhixuan.model.GoldLog">
		<result column="id" property="id" />
		<result column="start_no" property="startNo" />
		<result column="consume" property="consume" />
		<result column="commodity" property="commodity" />
		<result column="status" property="status" />
		<result column="warehouse_out" property="warehouseOut" />
		<result column="player_name" property="playerName" />
		<result column="player_phone" property="playerPhone" />
		<result column="player_address" property="playerAddress" />
		<result column="express" property="express" />
		<result column="express_code" property="expressCode" />
		<result column="create_time" property="createTime" />
		<result column="dispose_id" property="disposeId" />
		<result column="dispose_time" property="disposeTime" />
	</resultMap>
	
	<select id="selectGoldLogVoPage"  resultType="GoldLogVo">
       SELECT
			gl.id AS id,
			gl.start_no AS startNo,
			p.nick AS playerNick,
			gl.consume AS consume,
			gl.commodity AS commodity,
			c.commodity_name AS commodityName,
			gl.status AS status,
			gl.warehouse_out AS warehouseOut,
			wo.out_no AS warehouseOutNo,
			gl.player_name AS playerName,
			gl.player_phone AS playerPhone,
			gl.player_address AS playerAddress,
			gl.express AS express,
			gl.express_code AS expressCode,
			gl.create_time AS createTime,
			gl.dispose_id AS disposeId,
			u.name AS disposeName,
			gl.dispose_time AS disposeTime
		FROM gold_log gl 
		LEFT JOIN commodity c ON gl.commodity = c.id
		LEFT JOIN player p ON gl.start_no = p.start_no
		LEFT JOIN warehouse_out wo ON gl.warehouse_out IS NOT NULL AND gl.warehouse_out = wo.id
		LEFT JOIN user u ON gl.dispose_id IS NOT NULL AND gl.dispose_id = u.id
	        <where>
	        	1=1
	            <if test=" startNo != null and startNo != '' ">
	               and gl.start_no like concat(concat('%',#{startNo}),'%') 
	            </if>
	        </where>
		GROUP BY gl.id
    </select>
    
    <select id="selectGoldLogVoBy"  resultType="GoldLogVo">
       SELECT
			gl.id AS id,
			gl.start_no AS startNo,
			p.nick AS playerNick,
			gl.consume AS consume,
			gl.commodity AS commodity,
			c.commodity_name AS commodityName,
			gl.status AS status,
			gl.warehouse_out AS warehouseOut,
			wo.out_no AS warehouseOutNo,
			gl.player_name AS playerName,
			gl.player_phone AS playerPhone,
			gl.player_address AS playerAddress,
			gl.express AS express,
			gl.express_code AS expressCode,
			gl.create_time AS createTime,
			gl.dispose_id AS disposeId,
			u.name AS disposeName,
			gl.dispose_time AS disposeTime
		FROM gold_log gl 
		LEFT JOIN commodity c ON gl.commodity = c.id
		LEFT JOIN player p ON gl.start_no = p.start_no
		LEFT JOIN warehouse_out wo ON gl.warehouse_out IS NOT NULL AND gl.warehouse_out = wo.id
		LEFT JOIN user u ON gl.dispose_id IS NOT NULL AND gl.dispose_id = u.id
	        <where>
	        	1=1
	            <if test=" id != null">
	               and gl.id = #{id} 
	            </if>
	        </where>
		GROUP BY gl.id
    </select>

</mapper>
