require=function t(e,o,r){function n(i,a){if(!o[i]){if(!e[i]){var l="function"==typeof require&&require;if(!a&&l)return l(i,!0);if(c)return c(i,!0);var _=new Error("Cannot find module '"+i+"'");throw _.code="MODULE_NOT_FOUND",_}var d=o[i]={exports:{}};e[i][0].call(d.exports,function(t){var o=e[i][1][t];return n(o||t)},d,d.exports,t,e,o,r)}return o[i].exports}for(var c="function"==typeof require&&require,i=0;i<r.length;i++)n(r[i]);return n}({MathchingCard:[function(t,e,o){"use strict";cc._RF.push(e,"5ccaaQJ+ntKrqjY4MviWl6Y","MathchingCard"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,n=r.ccclass,c=r.property,i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.url="",e.edit_input=null,e.lblCardNum=null,e.lblError=null,e.node_card=null,e.node_hand_list=[],e.node_light_list=[],e._select=-1,e._cardCount=108,e._node_card_list=[],e._node_handCard_list=[[],[],[],[],[]],e.Click_Mathch_Card_Start=function(t){t.currentTarget.color=cc.Color.GRAY},e.Click_Mathch_Card_Cancel=function(t){t.currentTarget.color=cc.Color.WHITE},e.Click_Mathch_Card_End=function(t){var o=t.currentTarget;if(o.color=cc.Color.WHITE,e._select>=0&&e._select<e.node_hand_list.length){var r,n=e.node_hand_list[e._select];if(e._select!==e.node_hand_list.length-1)if(n.childrenCount<13)(r=cc.instantiate(o)).name="handCard"+n.childrenCount,r.setPosition(cc.p(0,0)),r.parent=n,e._node_handCard_list[e._select].push(r),e._cardCount-=1,e.setCardClickCount(1,o);else e.showError("这个位置最多设置13张手牌");else(r=cc.instantiate(o)).setPosition(cc.p(0,0)),r.parent=n,e._node_handCard_list[e._select].push(r),e._cardCount-=1,e.setCardClickCount(1,o);e.lblCardNum.string="剩余牌"+e._cardCount+"张"}else e.showError("请选中一个位置进行配牌");cc.log("---tag---"+o.tag)},e}return __extends(e,t),e.prototype.onLoad=function(){this.initData(),this.bindEvent()},e.prototype.initData=function(){this.edit_input.string=this.url,this._cardCount=108;for(var t=0;t<this.node_hand_list.length;t++)this.node_hand_list[t].removeAllChildren();this._select=-1;for(t=0;t<this.node_light_list.length;t++)this.node_light_list[t].active=!1;this.setCardClickCount(0)},e.prototype.editEnd=function(){var t=this.edit_input.string.trim();""!==t&&0!==t.length||(this.edit_input.string=this.url)},e.prototype.bindEvent=function(){for(var t=0;t<9;t++){var e="Match_Card_Wan"+(t+1),o=cc.find(e,this.node_card);o.tag=t+1,o.on("touchstart",this.Click_Mathch_Card_Start),o.on("touchcancel",this.Click_Mathch_Card_Cancel),o.on("touchend",this.Click_Mathch_Card_End);var r={cardNode:o,clickCount:0};this._node_card_list.push(r);var n="Match_Card_Tong"+(t+1),c=cc.find(n,this.node_card);c.tag=t+11,c.on("touchstart",this.Click_Mathch_Card_Start),c.on("touchcancel",this.Click_Mathch_Card_Cancel),c.on("touchend",this.Click_Mathch_Card_End);var i={cardNode:c,clickCount:0};this._node_card_list.push(i);var a="Match_Card_Tiao"+(t+1),l=cc.find(a,this.node_card);l.tag=t+21,l.on("touchstart",this.Click_Mathch_Card_Start),l.on("touchcancel",this.Click_Mathch_Card_Cancel),l.on("touchend",this.Click_Mathch_Card_End);var _={cardNode:l,clickCount:0};this._node_card_list.push(_)}},e.prototype.setCardClickCount=function(t,e){void 0===e&&(e=null);for(var o=0;o<this._node_card_list.length;o++){var r=this._node_card_list[o],n=cc.find("mask",r.cardNode);0!==t?r.cardNode.tag===e.tag&&(r.clickCount+=t,r.clickCount>=4?n.active=!0:n.active=!1):(r.clickCount=0,n.active=!1)}},e.prototype.showError=function(t){var e=this;void 0===t&&(t=""),this.lblError.node.stopAllActions(),this.lblError.node.opacity=255,this.lblError.string=t,t.length>0&&this.lblError.node.runAction(cc.sequence(cc.delayTime(1),cc.fadeOut(2),cc.callFunc(function(){e.lblError.string=""})))},e.prototype.click_btn_delete=function(){if(this._select>=0&&this._select<this.node_hand_list.length){var t=this._node_handCard_list[this._select].pop();t&&t.isValid&&(this.setCardClickCount(-1,t),t.removeFromParent(!0),t.destroy())}else this.showError("请选中一个位置")},e.prototype.click_btn_clear=function(){var t=this;-1!==this._select&&(this._node_handCard_list[this._select].forEach(function(e){t.setCardClickCount(-1,e),e.removeFromParent(!0),e.destroy()}),this._node_handCard_list[this._select].length=0,this.node_hand_list[this._select].removeAllChildren())},e.prototype.click_btn_ok=function(){for(var t=this,e=[],o=0;o<this.node_hand_list.length;o++){for(var r=[],n=0;n<this.node_hand_list[o].children.length;n++){var c=this.node_hand_list[o].children[n];c&&r.push(c.tag)}e[o]=r}cc.log(e);var i=this.url+JSON.stringify(e);cc.log(i),fetch(i).then(function(e){e.ok?(e.json().then(function(t){cc.log(t)}),t.showError("恭喜你,配牌成功,请创建房间,进入游戏!")):t.showError("服务器响应失败，请确认您的网络通畅后，重试！")}).catch(function(e){cc.log(e),t.showError("服务器响应失败，请确认您的网络通畅后，重试！")})},e.prototype.click_btn_reset=function(){this.initData()},e.prototype.click_node_player=function(t,e){Number(e)===this._select?this._select=-1:this._select=Number(e);for(var o=0;o<this.node_light_list.length;o++)o===this._select?this.node_light_list[o].active=!0:this.node_light_list[o].active=!1},e.prototype.click_btn_out=function(){this.node.removeFromParent(!0),this.node.destroy()},__decorate([c(cc.String)],e.prototype,"url",void 0),__decorate([c(cc.EditBox)],e.prototype,"edit_input",void 0),__decorate([c(cc.Label)],e.prototype,"lblCardNum",void 0),__decorate([c(cc.Label)],e.prototype,"lblError",void 0),__decorate([c(cc.Node)],e.prototype,"node_card",void 0),__decorate([c([cc.Node])],e.prototype,"node_hand_list",void 0),__decorate([c([cc.Node])],e.prototype,"node_light_list",void 0),e=__decorate([n],e)}(cc.Component);o.default=i,cc._RF.pop()},{}]},{},["MathchingCard"]);