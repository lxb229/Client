{"version":3,"sources":["IMGManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Modules","sourcesContent":["import ENCManager from './ENCManager';\r\n/**\r\n * 图片动态加载管理类\r\n * \r\n * @export\r\n * @class IMGManager\r\n */\r\nexport default class IMGManager {\r\n    private static _instance: IMGManager = null;\r\n    private constructor() { }\r\n    /**\r\n     * 获取IMGManager单例对象\r\n     * \r\n     * @static\r\n     * @returns {IMGManager} \r\n     * @memberof IMGManager\r\n     */\r\n    static getInstance(): IMGManager {\r\n        if (IMGManager._instance === null) {\r\n            IMGManager._instance = new IMGManager();\r\n        }\r\n        return IMGManager._instance;\r\n    }\r\n\r\n    /**\r\n     * 系统头像\r\n     * \r\n     * @private\r\n     * @type {cc.SpriteFrame}\r\n     * @memberof IMGManager\r\n     */\r\n    private headSpriteFrame: cc.SpriteFrame = null;\r\n\r\n    /**\r\n     * 表情集合\r\n     * \r\n     * @private\r\n     * @type {cc.SpriteFrame[]}\r\n     * @memberof IMGManager\r\n     */\r\n    bqSpriteFrames: cc.SpriteFrame[] = [];\r\n\r\n    /**\r\n     * 扑克牌集合\r\n     * \r\n     * @private\r\n     * @type {cc.SpriteFrame[]}\r\n     * @memberof IMGManager\r\n     */\r\n    private pokerSpriteFrames: cc.SpriteFrame[] = [];\r\n\r\n    /**\r\n     * 存放加载过的头像纹理\r\n     * \r\n     * @private\r\n     * @type {cc.SpriteFrame[]}\r\n     * @memberof IMGManager\r\n     */\r\n    private spriteFrames: cc.SpriteFrame[] = [];\r\n\r\n    /** \r\n     * 把加载成功的纹理存放到数组，待释放的时候使用\r\n     * \r\n     * @param {cc.SpriteFrame} spriteFrame  添加纹理\r\n     * @memberof IMGManager\r\n     */\r\n    private addSpriteFrame(spriteFrame: cc.SpriteFrame): void {\r\n        let bool: boolean = this.spriteFrames.some((sf) => {\r\n            return sf === spriteFrame;\r\n        });\r\n        if (!bool) this.spriteFrames.push(spriteFrame);\r\n    }\r\n    /**\r\n     * 初始化加载图片资源\r\n     * \r\n     * @returns {Promise<void>} \r\n     * @memberof IMGManager\r\n     */\r\n    async initIMG(): Promise<void> {\r\n        this.headSpriteFrame = await this.initSystemHead();\r\n        this.bqSpriteFrames.length = 0;\r\n        this.bqSpriteFrames = await this.initAtlas('Atlas/bq');\r\n        this.pokerSpriteFrames.length = 0;\r\n        this.pokerSpriteFrames = await this.initAtlas('Atlas/poker');\r\n    }\r\n    /**\r\n     * 根据资源名排序\r\n     * \r\n     * @param {cc.SpriteFrame[]} spriteFrames \r\n     * @memberof IMGManager\r\n     */\r\n    private sortByName(spriteFrames: cc.SpriteFrame[]) {\r\n        if (spriteFrames && spriteFrames.length > 1) {\r\n            spriteFrames.sort((a: cc.SpriteFrame, b: cc.SpriteFrame) => {\r\n                return Number(a.name) - Number(b.name);\r\n            })\r\n        }\r\n    }\r\n    /**\r\n     * 根据id获取扑克图片\r\n     * \r\n     * @param {number} id \r\n     * @returns {cc.SpriteFrame} \r\n     * @memberof IMGManager\r\n     */\r\n    getPokerSpriteFrameById(id: number): cc.SpriteFrame {\r\n        let res: cc.SpriteFrame = null;\r\n        if (this.pokerSpriteFrames && this.pokerSpriteFrames.length > 0) {\r\n            for (let i = 0; i < this.pokerSpriteFrames.length; i++) {\r\n                let spriteFrame = this.pokerSpriteFrames[i];\r\n                if (Number(spriteFrame.name) === id) {\r\n                    res = spriteFrame;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return res;\r\n    }\r\n\r\n    /**\r\n     * 初始化，动态加载系统头像\r\n     * \r\n     * @returns {Promise<void>} \r\n     * @memberof IMGManager\r\n     */\r\n    private initSystemHead(): Promise<cc.SpriteFrame> {\r\n        return new Promise<cc.SpriteFrame>((resolve, reject) => {\r\n            cc.loader.loadRes(\"Texture/systemHead\", cc.SpriteFrame, (err: Error, spriteFrame: cc.SpriteFrame) => {\r\n                if (err) {\r\n                    reject(err.message);\r\n                }\r\n                else {\r\n                    resolve(spriteFrame);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    private initAtlas(path: string): Promise<cc.SpriteFrame[]> {\r\n        return new Promise<cc.SpriteFrame[]>((resolve, reject) => {\r\n            cc.loader.loadRes(path, cc.SpriteAtlas, (err: Error, spriteAtlas: cc.SpriteAtlas) => {\r\n                if (err) {\r\n                    reject(err.message);\r\n                }\r\n                else {\r\n                    let spriteFrames: cc.SpriteFrame[] = spriteAtlas.getSpriteFrames();\r\n                    this.sortByName(spriteFrames);\r\n                    cc.loader.release(spriteAtlas);\r\n                    resolve(spriteFrames);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * 获取图片目录\r\n     * \r\n     * @returns {string} \r\n     * @memberof IMGManager\r\n     */\r\n    private getDirPath(): string {\r\n        //图片保存目录\r\n        let dirpath = jsb.fileUtils.getWritablePath() + 'img/';\r\n        //验证路径是否存在，如果不存在则创建路径\r\n        if (!jsb.fileUtils.isDirectoryExist(dirpath)) {\r\n            jsb.fileUtils.createDirectory(dirpath);\r\n        }\r\n        return dirpath;\r\n    }\r\n\r\n    /**\r\n     * 根据url地址获取本地路径\r\n     * \r\n     * @param {string} url \r\n     * @returns {string} \r\n     * @memberof IMGManager\r\n     */\r\n    private getFilePath(url: string): string {\r\n        return this.getDirPath() + ENCManager.getInstance().MD5(url) + '.jpg';\r\n    }\r\n\r\n    /**\r\n     * 根据路径加载本地存储的图片\r\n     * \r\n     * @param {string} filePath 图片路径\r\n     * @returns {Promise<cc.SpriteFrame>} \r\n     * @memberof IMGManager\r\n     */\r\n    private loadLocalImg(filePath: string): Promise<cc.SpriteFrame> {\r\n        return new Promise<cc.SpriteFrame>((resolve, reject) => {\r\n            cc.loader.load(filePath, (err, tex) => {\r\n                if (err) {\r\n                    reject(err);\r\n                } else {\r\n                    let spriteFrame = new cc.SpriteFrame(tex);\r\n                    this.addSpriteFrame(spriteFrame);\r\n                    resolve(spriteFrame);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 根据url加载图片，长度为0取系统头像，大于0取微信头像\r\n     * \r\n     * @param {string} url 头像地址\r\n     * @returns {Promise<cc.SpriteFrame>} \r\n     * @memberof IMGManager\r\n     */\r\n    async loadURLImage(url: string): Promise<cc.SpriteFrame> {\r\n        if (url.length > 0) {//取微信头像\r\n            if (cc.sys.isNative) {\r\n                let filePath = this.getFilePath(url);\r\n                if (jsb.fileUtils.isFileExist(filePath)) {\r\n                    return this.loadLocalImg(filePath);\r\n                } else {\r\n                    let buffer = await new Promise<ArrayBuffer>((resolve, reject) => {\r\n                        let xhr = new XMLHttpRequest()\r\n                        xhr.responseType = 'arraybuffer';\r\n                        xhr.timeout = 10000;\r\n                        xhr.onload = () => {\r\n                            if (xhr.status === 200) {\r\n                                resolve(xhr.response);\r\n                            } else {\r\n                                reject(new TypeError('Network response failed'));\r\n                            }\r\n                        }\r\n                        xhr.onerror = () => {\r\n                            reject(new TypeError('Network request error'));\r\n                        }\r\n                        xhr.ontimeout = () => {\r\n                            reject(new TypeError('Network request timeout'));\r\n                        }\r\n                        xhr.open(\"GET\", url, true);\r\n                        xhr.send();\r\n                    });\r\n                    jsb.fileUtils.writeDataToFile(new Uint8Array(buffer), filePath);\r\n                    return this.loadLocalImg(filePath);\r\n                }\r\n            } else {\r\n                return new Promise<cc.SpriteFrame>((resolve, reject) => {\r\n                    cc.loader.load({ url: url, type: 'jpg' }, (err, tex) => {\r\n                        if (err) {\r\n                            reject(err);\r\n                        } else {\r\n                            let spriteFrame = new cc.SpriteFrame(tex);\r\n                            this.addSpriteFrame(spriteFrame);\r\n                            resolve(spriteFrame);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        } else {//取系统头像\r\n            return this.headSpriteFrame;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 释放图片管理器的资源\r\n     * \r\n     * @memberof IMGManager\r\n     */\r\n    destroySelf(): void {\r\n        this.destrySpriteFrames(this.spriteFrames);\r\n        this.destrySpriteFrames(this.bqSpriteFrames);\r\n        this.destrySpriteFrames(this.pokerSpriteFrames);\r\n        this.release(this.headSpriteFrame);\r\n        this.headSpriteFrame = null;\r\n        IMGManager._instance = null;\r\n    }\r\n    /**\r\n     * 释放图集\r\n     * \r\n     * @private\r\n     * @param {cc.SpriteFrame[]} spriteFrames \r\n     * @memberof IMGManager\r\n     */\r\n    private destrySpriteFrames(spriteFrames: cc.SpriteFrame[]) {\r\n        spriteFrames.forEach((spriteFrame: cc.SpriteFrame) => {\r\n            this.release(spriteFrame);\r\n        }, this);\r\n        spriteFrames.length = 0;\r\n    }\r\n\r\n    /**\r\n     * 释放资源及其所有的引用\r\n     * \r\n     * @private\r\n     * @param {(cc.Asset | cc.RawAsset | string)} owner 需要释放的资源\r\n     * @memberof IMGManager\r\n     */\r\n    private release(owner: cc.Asset | cc.RawAsset | string): void {\r\n        let deps = cc.loader.getDependsRecursively(owner);\r\n        cc.loader.release(deps);\r\n    }\r\n}\r\n    //http://wx.qlogo.cn/mmopen/g3MonUZtNHkdmzicIlibx6iaFqAc56vxLSUfpb6n5WKSYVY0ChQKkiaJSgQ1dZuTOgvLLrhJbERQQ4eMsv84eavHiaiceqxibJxCfHe/0"]}