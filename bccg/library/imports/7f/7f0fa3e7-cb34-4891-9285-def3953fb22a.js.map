{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Home/assets\\Script\\SceneScript\\Home\\HomeCanvas.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Home","sourcesContent":["const { ccclass, property } = cc._decorator;\r\nimport * as dd from './../../Modules/ModuleManager';\r\n\r\n@ccclass\r\nexport default class HomeCanvas extends cc.Component {\r\n    /**\r\n     * 头像\r\n     * \r\n     * @type {cc.Sprite}\r\n     * @memberof HomeCanvas\r\n     */\r\n    @property(cc.Sprite)\r\n    spr_head: cc.Sprite = null;\r\n    /**\r\n     * 用户昵称\r\n     * \r\n     * @type {cc.Label}\r\n     * @memberof HomeCanvas\r\n     */\r\n    @property(cc.Label)\r\n    lab_name: cc.Label = null;\r\n    /**\r\n     * 玩家id\r\n     * \r\n     * @type {cc.Label}\r\n     * @memberof HomeCanvas\r\n     */\r\n    @property(cc.Label)\r\n    lab_id: cc.Label = null;\r\n    /**\r\n     * 设置界面\r\n     * \r\n     * @type {cc.Prefab}\r\n     * @memberof HomeCanvas\r\n     */\r\n    @property(cc.Prefab)\r\n    pre_setting: cc.Prefab = null;\r\n    /**\r\n     * 创建界面\r\n     * \r\n     * @type {cc.Prefab}\r\n     * @memberof HomeCanvas\r\n    */\r\n    @property(cc.Prefab)\r\n    pre_create: cc.Prefab = null;\r\n    /**\r\n     * 加入房间\r\n     * \r\n     * @type {cc.Prefab}\r\n     * @memberof HomeCanvas\r\n     */\r\n    @property(cc.Prefab)\r\n    pre_join: cc.Prefab = null;\r\n\r\n    /**\r\n     * 公告父节点\r\n     * \r\n     * @type {cc.Node}\r\n     * @memberof HomeCanvas\r\n     */\r\n    @property(cc.Node)\r\n    noticeNode: cc.Node = null;\r\n    /**\r\n     * 公告内容\r\n     * @type {cc.Node}\r\n     * @memberof HomeCanvas\r\n     */\r\n    @property(cc.Label)\r\n    lblNoticeCT: cc.Label = null;\r\n    /**\r\n     * 跑马灯节点\r\n     * \r\n     * @type {cc.Node}\r\n     * @memberof HomeCanvas\r\n     */\r\n    @property(cc.Node)\r\n    msgLayout: cc.Node = null;\r\n\r\n    /**\r\n     * 是否在跑公告\r\n     * \r\n     * @type {boolean}\r\n     * @memberof HomeCanvas\r\n     */\r\n    _isRunNotice: boolean = false;\r\n\r\n    onLoad() {\r\n        cc.log(dd.ud_manager.account_mine);\r\n    }\r\n\r\n    async update(dt: number) {\r\n        if (dd.ud_manager && dd.ud_manager.account_mine) {\r\n            if (dd.ud_manager.account_mine.roleAttribVo) {\r\n                this.lab_name.string = dd.utils.getStringBySize(dd.ud_manager.account_mine.roleAttribVo.nick, 12);\r\n                this.lab_id.string = dd.ud_manager.account_mine.roleAttribVo.starNO;\r\n                try {\r\n                    this.spr_head.spriteFrame = await dd.img_manager.loadURLImage(dd.ud_manager.account_mine.roleAttribVo.headImg);\r\n                } catch (error) {\r\n                    cc.log('获取头像错误');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 更新公告显示位置（跑灯效果）\r\n     * \r\n     * @memberof HomeCanvas\r\n     */\r\n    checkPos() {\r\n        if (this._isRunNotice) {\r\n            let widget = this.msgLayout.getComponent(cc.Widget);\r\n            if (widget.left < 0 && Math.abs(widget.left) >= this.msgLayout.width) {\r\n                this.msgLayout.removeAllChildren();\r\n                widget.left = this.noticeNode.width;\r\n                this._isRunNotice = false;\r\n                this.noticeNode.active = false;\r\n            } else {\r\n                widget.left -= 1;\r\n            }\r\n        } else {\r\n            if (dd.ud_manager && dd.ud_manager.noticeList && dd.ud_manager.noticeList.length > 0) {\r\n                this.createNotice(dd.ud_manager.noticeList.shift());\r\n            } else {\r\n                let np: NoticeParamAttrib = {\r\n                    content: '抵制不良游戏, 拒绝盗版游戏。 注意自我保护, 谨防受骗上当。 适度游戏益脑, 沉迷游戏伤身。 合理安排时间, 享受健康生活！',\r\n                    type: 2,\r\n                    color: [150, 150, 150]\r\n                };\r\n\r\n                let notice: NoticeNotify = {\r\n                    msgId: '0',\r\n                    contents: [np],\r\n                };\r\n                this.createNotice(notice);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 创建公告消息\r\n     * \r\n     * @memberof HomeCanvas\r\n     */\r\n    createNotice(data: NoticeNotify) {\r\n        this.msgLayout.removeAllChildren();\r\n        for (let i = 0; i < data.contents.length; i++) {\r\n            let msgData = data.contents[i];\r\n            let tNode = new cc.Node('notice');\r\n            tNode.color = new cc.Color(msgData.color[0], msgData.color[1], msgData.color[2]);\r\n            let lbl = tNode.addComponent(cc.Label);\r\n            lbl.fontSize = 30;\r\n            lbl.lineHeight = 30;\r\n            lbl.overflow = cc.Label.Overflow.NONE;\r\n            lbl.horizontalAlign = cc.Label.HorizontalAlign.CENTER;\r\n            lbl.verticalAlign = cc.Label.VerticalAlign.CENTER;\r\n            lbl.string = msgData.content;\r\n            // lbl.string = '大王叫我来巡山，我来牌馆转一转。胡着我的牌，数着赢的钱，生活充满节奏感。';\r\n            this.msgLayout.addChild(tNode);\r\n        }\r\n        this._isRunNotice = true;\r\n        this.noticeNode.active = true;\r\n    }\r\n\r\n    /**\r\n     * 点击设置按钮\r\n     * \r\n     * @memberof HomeCanvas\r\n     */\r\n    click_setting() {\r\n        dd.ui_manager.showLoading();\r\n        dd.mp_manager.playButton();\r\n        let setNode = cc.instantiate(this.pre_setting);\r\n        setNode.parent = dd.ui_manager.getRootNode();\r\n    }\r\n    /**\r\n     * 点击公告按钮\r\n     * \r\n     * @memberof HomeCanvas\r\n     */\r\n    click_notice() {\r\n        dd.ui_manager.showLoading();\r\n        dd.mp_manager.playButton();\r\n\r\n    }\r\n    /**\r\n     * 点击生涯按钮\r\n     * \r\n     * @memberof HomeCanvas\r\n     */\r\n    click_career() {\r\n        dd.ui_manager.showLoading();\r\n        dd.mp_manager.playButton();\r\n    }\r\n    /**\r\n     * 点击商店按钮\r\n     * \r\n     * @memberof HomeCanvas\r\n     */\r\n    click_store() {\r\n\r\n    }\r\n    /**\r\n     * 点击创建房间\r\n     * \r\n     * @memberof HomeCanvas\r\n     */\r\n    click_create() {\r\n        dd.ui_manager.showLoading();\r\n        dd.mp_manager.playButton();\r\n        let createNode = cc.instantiate(this.pre_create);\r\n        dd.ws_manager.sendMsg(dd.protocol.DZPKER_TABLE_GET_CFG, '', (flag: number, content?: any) => {\r\n            if (flag === 0) {\r\n                let cfg: CreateCfg = content as CreateCfg;\r\n                createNode.getComponent('Create').init(cfg);\r\n                createNode.parent = dd.ui_manager.getRootNode();\r\n            } else if (flag === -1) {\r\n                dd.ui_manager.showTip('获取房间配置消息发送超时');\r\n            } else {\r\n                dd.ui_manager.showTip(content);\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * 点击加入房间\r\n     * \r\n     * @memberof HomeCanvas\r\n     */\r\n    click_join() {\r\n        dd.ui_manager.showLoading();\r\n        dd.mp_manager.playButton();\r\n        let joinNode = cc.instantiate(this.pre_join);\r\n        joinNode.parent = dd.ui_manager.getRootNode();\r\n    }\r\n    /**\r\n     * 点击我的房间\r\n     * \r\n     * @memberof HomeCanvas\r\n     */\r\n    click_mine() {\r\n        dd.ui_manager.showLoading();\r\n        dd.mp_manager.playButton();\r\n\r\n    }\r\n}\r\n"]}