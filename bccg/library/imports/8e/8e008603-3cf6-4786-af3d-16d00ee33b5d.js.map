{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Login/assets\\Script\\SceneScript\\Login\\LoginCanvas.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Login","sourcesContent":["const { ccclass, property } = cc._decorator;\r\nimport * as dd from './../../Modules/ModuleManager';\r\n\r\n@ccclass\r\nexport default class LoginCanvas extends cc.Component {\r\n    /**\r\n     * 微信登录按钮\r\n     * \r\n     * @type {cc.Button}\r\n     * @memberof LoginCanvas\r\n     */\r\n    @property(cc.Button)\r\n    btn_wechat: cc.Button = null;\r\n    /**\r\n     * 快速登录按钮\r\n     * \r\n     * @type {cc.Button}\r\n     * @memberof LoginCanvas\r\n     */\r\n    @property(cc.Button)\r\n    btn_quick: cc.Button = null;\r\n\r\n    @property(cc.Toggle)\r\n    tog_yhxy: cc.Toggle = null;\r\n\r\n    @property(cc.Node)\r\n    yhxy_layer: cc.Node = null;\r\n    /**\r\n     * 微信登录结果回调\r\n     * \r\n     * @memberof LoginCanvas\r\n     */\r\n    cb_login: (event: cc.Event.EventCustom) => void = (event: cc.Event.EventCustom) => {\r\n        let detail = event.detail;\r\n        if (detail.flag === 1) {//成功\r\n            let userInfo: UserInfo = detail.data;\r\n            userInfo.headimgurl = dd.utils.getHeadImgUrl(userInfo.headimgurl);\r\n            this.wsLogin(dd.protocol.ACCOUNT_LOGIN_WX, userInfo);\r\n        } else {//失败\r\n            dd.ui_manager.showTip(detail.data as string);\r\n        }\r\n    }\r\n    /**\r\n     * ccc组件释放的生命周期回调\r\n     * \r\n     * @memberof LoginCanvas\r\n     */\r\n    onDestroy() {\r\n        if (dd.config.wxState === 0) {\r\n            cc.systemEvent.off('cb_login', this.cb_login, this);\r\n        }\r\n    }\r\n    async onLoad() {\r\n        if (cc.sys.localStorage.getItem('isRead')) {\r\n            this.tog_yhxy.check();\r\n        } else {\r\n            this.tog_yhxy.uncheck();\r\n        }\r\n        this.yhxy_layer.active = false;\r\n        this.btn_quick.node.active = true;\r\n        this.btn_wechat.node.active = false;\r\n        dd.ui_manager.showLoading();\r\n        try {\r\n            await dd.ws_manager.connect(dd.config.wsUrl);//连接服务器\r\n            if (dd.config.wxState === 0) {\r\n                this.btn_quick.node.active = false;\r\n                this.btn_wechat.node.active = true;\r\n                //注册微信登录回调\r\n                cc.systemEvent.on('cb_login', this.cb_login, this);\r\n                //微信自动登录\r\n                await this.aotuLogin();\r\n            } else {\r\n                dd.ui_manager.hideLoading();\r\n            }\r\n        } catch (errMsg) {\r\n            dd.ui_manager.showAlert(2, errMsg, () => {\r\n                this.onLoad();\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 微信自动登录\r\n     * \r\n     * @returns {Promise<void>} \r\n     * @memberof LoginCanvas\r\n     */\r\n    async aotuLogin(): Promise<void> {\r\n        let db = cc.sys.localStorage;\r\n        if (db.getItem('TokenInfo')) {//验证是否有授权过\r\n            try {\r\n                let data: TokenInfo = JSON.parse(db.getItem('TokenInfo'));\r\n                //刷新token过期时间\r\n                let url_refresh = 'https://api.weixin.qq.com/sns/oauth2/refresh_token?appid=' + dd.config.app_id + '&grant_type=refresh_token&refresh_token=' + data.refresh_token;\r\n                let response_refresh = await fetch(url_refresh);\r\n                if (response_refresh.ok) {//请求成功\r\n                    let newToken: TokenInfo = await response_refresh.json();\r\n                    db.setItem('TokenInfo', JSON.stringify(newToken));\r\n                    let url_userInfo = 'https://api.weixin.qq.com/sns/userinfo?access_token=' + newToken.access_token + '&openid=' + newToken.openid;\r\n                    let response_userInfo = await fetch(url_userInfo);\r\n                    if (response_userInfo.ok) {//获取用户信息成功\r\n                        let userInfo = await response_userInfo.json();\r\n                        userInfo.headimgurl = dd.utils.getHeadImgUrl(userInfo.headimgurl);\r\n                        this.wsLogin(dd.protocol.ACCOUNT_LOGIN_WX, userInfo);\r\n                    } else {//获取用户信息失败\r\n                        dd.ui_manager.showTip('微信用户信息获取失败，请重新授权登录');\r\n                    }\r\n                } else {//授权过期需要重新授权\r\n                    dd.ui_manager.showTip('微信授权过期，请重新授权登录');\r\n                }\r\n            } catch (err) {\r\n                dd.ui_manager.showTip('微信请求异常，请重新授权登录');\r\n            }\r\n        } else {\r\n            dd.ui_manager.hideLoading();\r\n        }\r\n    }\r\n    /**\r\n     * 微信登录\r\n     * \r\n     * @returns \r\n     * @memberof LoginCanvas\r\n     */\r\n    click_wx() {\r\n        if (!this.tog_yhxy.isChecked) {\r\n            dd.ui_manager.showTip('请先阅读游戏声明！');\r\n            return;\r\n        }\r\n        if (!dd.ui_manager.showLoading('准备跳往微信授权登录')) return;\r\n        setTimeout(() => {\r\n            dd.js_call_native.wxLogin();\r\n        }, 1000);\r\n    }\r\n    /**\r\n     * ws登录请求\r\n     * \r\n     * @param {number} msgId 协议号\r\n     * @param {UserInfo} [info] 微信获取的数据对象\r\n     * @memberof LoginCanvas\r\n     */\r\n    wsLogin(msgId: number, info?: UserInfo): void {\r\n        dd.mp_manager.playButton();\r\n        let obj: any = {};\r\n        if (info) {\r\n            obj.uuid = info.unionid;\r\n            obj.headImg = info.headimgurl;\r\n            obj.nick = info.nickname;\r\n            obj.sex = info.sex;\r\n        } else {\r\n            obj.uuid = this.getGuestAccount();\r\n        }\r\n        dd.ws_manager.sendMsg(\r\n            msgId,\r\n            JSON.stringify(obj),\r\n            (flag: number, content?: any) => {\r\n                if (flag === 0) {//登录服务器成功\r\n                    dd.ud_manager.account_mine = content as AccountData;\r\n                    dd.ws_manager.setLoginState(true);\r\n                    if (dd.ud_manager.account_mine.gameDataAttribVo.tableId !== 0) {\r\n                        this.getTableData(0);\r\n                    } else {\r\n                        setTimeout(() => {\r\n                            cc.director.loadScene('HomeScene');\r\n                        }, 1000);\r\n                    }\r\n                } else if (flag === -1) {\r\n                    dd.ui_manager.showTip('登录消息超时');\r\n                } else {//登录服务器失败\r\n                    dd.ui_manager.showTip(content);\r\n                }\r\n            });\r\n    }\r\n    /**\r\n     * 游客登录\r\n     * \r\n     * @returns \r\n     * @memberof LoginCanvas\r\n     */\r\n    click_quick() {\r\n        if (!this.tog_yhxy.isChecked) {\r\n            dd.ui_manager.showTip('请先阅读游戏声明！');\r\n            return;\r\n        }\r\n        if (!dd.ui_manager.showLoading('正在登录中,请稍后')) return;\r\n        this.wsLogin(dd.protocol.ACCOUNT_LOGIN_TOURIST);\r\n    }\r\n    /**\r\n     * 获取当前最新的桌子数据\r\n     * \r\n     * @param {number} count 请求次数\r\n     * @memberof LoginCanvas\r\n     */\r\n    getTableData(count: number) {\r\n        dd.ws_manager.sendMsg(\r\n            dd.protocol.DZPKER_TABLE_GET_TABLE_INFO,\r\n            JSON.stringify({ tableId: dd.ud_manager.account_mine.gameDataAttribVo.tableId }),\r\n            (flag: number, content?: any) => {\r\n                if (flag === 0) {\r\n                    dd.gm_manager.setTableData(content as TableData, 1);\r\n                    cc.director.loadScene('GameScene', () => {\r\n                        dd.ui_manager.showTip('返回牌局成功!');\r\n                    });\r\n                } else {\r\n                    count++;\r\n                    if (count > 3) {\r\n                        dd.ui_manager.showAlert(2, '连接服务器失败,请确认网络后重新启动游戏!', () => {\r\n                            cc.game.end();\r\n                        });\r\n                    } else {\r\n                        this.getTableData(count);\r\n                    }\r\n                }\r\n            });\r\n    }\r\n\r\n    /**\r\n     * 获取uuid，第一次运行创建uuid\r\n     * \r\n     * @returns \r\n     * @memberof LoginCanvas\r\n     */\r\n    getGuestAccount(): string {\r\n        let db = cc.sys.localStorage;\r\n        let uuid = db.getItem('uuid');\r\n        if (uuid && uuid.length === 32) {\r\n            return uuid;\r\n        } else {\r\n            uuid = dd.utils.createUUID(32, 16);\r\n            db.setItem('uuid', uuid);\r\n            return uuid;\r\n        }\r\n    }\r\n\r\n    click_Tog() {\r\n        dd.mp_manager.playButton();\r\n        cc.sys.localStorage.setItem('isRead', true);\r\n        this.yhxy_layer.active = true;\r\n        this.tog_yhxy.check();\r\n    }\r\n\r\n    click_close() {\r\n        dd.mp_manager.playButton();\r\n        this.yhxy_layer.active = false;\r\n    }\r\n}\r\n"]}